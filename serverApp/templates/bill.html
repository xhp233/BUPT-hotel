{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bill Information</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Bill Information</h1>
    <table class="table">
        <thead>
            <tr>
                <th scope="col">Room Number</th>
                <th scope="col">Status</th>
                <th scope="col">Current Temperature</th>
                <th scope="col">Target Temperature</th>
                <th scope="col">Speed</th>
                <th scope="col">Time</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ bill_Info.roomNo.roomNo }}</td>
                <td>{{ bill_Info.status }}</td>
                <td>{{ bill_Info.current_temperature }}</td>
                <td>{{ bill_Info.target_temperature }}</td>
                <td>{{ bill_Info.speed }}</td>
                <td>{{ bill_Info.time }}</td>
            </tr>
        </tbody>
    </table>
    <button id="btn-export-image">导出为PDF</button>
    <button id="btn-export-excel">导出为Excel</button>
    <br><br>
    <a class="btn btn-primary" href="{% url 'receptionist' %}">Back</a>

    <script>
        // 导出为图片
        document.getElementById('btn-export-image').addEventListener('click', function() {
        html2canvas(document.querySelector('.table')).then(function(canvas) {
            var imgData = canvas.toDataURL('image/png');
            var doc = new jsPDF('p', 'mm', 'a4');  // 创建一个A4大小的PDF
            var width = doc.internal.pageSize.getWidth();  // 获取PDF的宽度
            var height = canvas.height * width / canvas.width;  // 计算图片的高度，保持图片的原始宽高比
            doc.addImage(imgData, 'PNG', 0, 0, width, height);  // 将图片添加到PDF，图片的宽度为PDF的宽度，高度按照原始宽高比计算
            doc.save('bill.pdf');
            });
        });

        // 导出为Excel
        document.getElementById('btn-export-excel').addEventListener('click', function() {
            var wb = XLSX.utils.table_to_book(document.querySelector('.table'));
            XLSX.writeFile(wb, 'bill.xlsx');
        });
    </script>
</body>
</html>
<!--
---bill_Info---
    roomNo = models.ForeignKey(Room, on_delete=models.CASCADE)
    status = models.CharField(max_length=50,default='')
    current_temperature = models.CharField(max_length=50,default='')
    target_temperature = models.CharField(max_length=50,default='')
    speed = models.CharField(max_length=50,default='')
    time = models.DateTimeField(auto_now=True)
-->